================================================================================
RELAT√ìRIO MICROCICLO 1 - INVENT√ÅRIO DOM DE BOT√ïES
Data: 28/10/2025
P√°ginas Auditadas: Lista de Empresas (CompaniesManagementPage) + Detalhe da Empresa (CompanyDetailPage)
================================================================================

RESUMO EXECUTIVO
--------------------------------------------------------------------------------
Total de bot√µes mapeados: 31 bot√µes √∫nicos
Distribui√ß√£o:
  - Toolbar Global (Lista): 6 bot√µes
  - Card de Busca/Filtros (Lista): 5 bot√µes
  - A√ß√µes por Linha/Empresa (Lista): 9 bot√µes
  - Header Detalhe da Empresa: 7 bot√µes
  - Aba "A√ß√µes" no Detalhe: 4 bot√µes

Status Geral: ‚ö†Ô∏è PROBLEMAS IDENTIFICADOS
  - Redund√¢ncia de bot√µes (mesma fun√ß√£o em m√∫ltiplos locais)
  - Falta de toolbar de processamento em massa
  - Falta de menu consolidado "A√ß√µes" (engrenagem)
  - Bot√£o "Criar Estrat√©gia" aparece sem valida√ß√£o de pr√©-requisitos

================================================================================

SE√á√ÉO 1: TOOLBAR GLOBAL (TOPO DA LISTA DE EMPRESAS)
Localiza√ß√£o: src/pages/CompaniesManagementPage.tsx (linhas 712-877)
Data-testid esperado: companies-toolbar
Contexto: Bot√µes no header da p√°gina, ao lado do t√≠tulo
--------------------------------------------------------------------------------

Bot√£o 1: Upload em Massa
  - Label: [√≠cone Upload]
  - Data-testid: N√£o definido
  - Aria-label: N√£o definido
  - Container: global (header)
  - Disabled: false
  - HasOnClick: true
  - Tipo: BulkUploadDialog
  - A√ß√£o esperada: Abrir dialog de upload em massa
  - Endpoint: N√£o aplic√°vel (componente local)
  - Status: ‚úÖ OK - Funcional
  - Observa√ß√µes: √çcone-only, tooltip "Upload em Massa"

Bot√£o 2: Receita Federal (Lote)
  - Label: [√≠cone Building2]
  - Data-testid: N√£o definido
  - Aria-label: N√£o definido
  - Container: global (header)
  - Disabled: Quando isBatchEnriching=true
  - HasOnClick: true ‚Üí handleBatchEnrichReceitaWS
  - A√ß√£o esperada: Enriquecer em lote com Receita Federal
  - Endpoint: POST /functions/v1/batch-enrich-receitaws
  - Status: ‚úÖ OK - Funcional
  - Observa√ß√µes: Spinner quando ativo, tooltip "Receita Federal (Lote)"

Bot√£o 3: Enriquecimento 360¬∞ Completo
  - Label: [√≠cone Sparkles]
  - Data-testid: N√£o definido
  - Aria-label: N√£o definido
  - Container: global (header)
  - Disabled: Quando isBatchEnriching360=true
  - HasOnClick: true ‚Üí handleBatchEnrich360
  - A√ß√£o esperada: Enriquecer em lote com an√°lise 360¬∞
  - Endpoint: POST /functions/v1/batch-enrich-360
  - Status: ‚úÖ OK - Funcional
  - Observa√ß√µes: Spinner quando ativo, tooltip "Enriquecimento 360¬∞ Completo"

Bot√£o 4: Apollo (Decisores & Contatos)
  - Label: [√≠cone Apollo img]
  - Data-testid: N√£o definido
  - Aria-label: N√£o definido
  - Container: global (header)
  - Disabled: Quando isBatchEnrichingApollo=true
  - HasOnClick: true ‚Üí handleBatchEnrichApollo
  - A√ß√£o esperada: Enriquecer em lote com Apollo (decisores)
  - Endpoint: POST /functions/v1/enrich-apollo (type: batch_enrich)
  - Status: ‚úÖ OK - Funcional
  - Observa√ß√µes: Spinner quando ativo, tooltip "Apollo (Decisores & Contatos)", gradient purple-to-blue

Bot√£o 5: Eco-Booster (Lote)
  - Label: [√≠cone Zap]
  - Data-testid: N√£o definido
  - Aria-label: N√£o definido
  - Container: global (header)
  - Disabled: Quando isBatchEnrichingEconodata=true
  - HasOnClick: true ‚Üí loop inline de supabase.functions.invoke('enrich-econodata')
  - A√ß√£o esperada: Enriquecer em lote com Econodata
  - Endpoint: POST /functions/v1/enrich-econodata (m√∫ltiplas chamadas)
  - Status: ‚úÖ OK - Funcional
  - Observa√ß√µes: Spinner quando ativo, tooltip "Eco-Booster (Lote)"

Bot√£o 6: Buscar Empresas (lupa)
  - Label: [√≠cone Search]
  - Data-testid: N√£o definido
  - Aria-label: N√£o definido
  - Container: global (header)
  - Disabled: false
  - HasOnClick: true ‚Üí navigate('/search')
  - A√ß√£o esperada: Navegar para p√°gina de busca/adicionar empresas
  - Endpoint: N√£o aplic√°vel (roteamento)
  - Status: ‚úÖ OK - Funcional
  - Observa√ß√µes: √çcone-only, tooltip "Buscar Empresas"

‚ö†Ô∏è PROBLEMAS IDENTIFICADOS NESTA SE√á√ÉO:
  - FALTA: Bot√£o "Selecionar tudo / Limpar sele√ß√£o" (s√≥ existe no header da tabela como checkbox)
  - FALTA: Bot√£o "Deletar empresas selecionadas" (foi removido)
  - FALTA: Menu dropdown "Enriquecer em lote" consolidado
  - FALTA: Bot√£o "Exportar selecionadas"
  - FALTA: Bot√£o "Diagn√≥stico em lote"
  - FALTA: Bot√£o "Configurar Integra√ß√µes"
  - Todos os bot√µes s√£o icon-only, sem labels visuais (s√≥ tooltips)
  - Nenhum bot√£o tem data-testid definido (dificulta automa√ß√£o)

================================================================================

SE√á√ÉO 2: CARD DE BUSCA/FILTROS (LISTA DE EMPRESAS)
Localiza√ß√£o: src/pages/CompaniesManagementPage.tsx (linhas 879-941)
Data-testid: N√£o definido
Contexto: Card abaixo do header com input de busca e bot√µes de a√ß√£o
--------------------------------------------------------------------------------

Bot√£o 7: Atualizar (Refresh)
  - Label: "Atualizar" + √≠cone RefreshCw
  - Data-testid: N√£o definido
  - Aria-label: N√£o definido
  - Container: global (search card)
  - Disabled: false
  - HasOnClick: true ‚Üí handleRefresh
  - A√ß√£o esperada: Recarregar lista de empresas
  - Endpoint: GET /rest/v1/companies (via refetch)
  - Status: ‚úÖ OK - Funcional
  - Observa√ß√µes: √çcone gira quando loading=true

Bot√£o 8: Exportar PDF
  - Label: "PDF" + √≠cone FileText
  - Data-testid: N√£o definido
  - Aria-label: N√£o definido
  - Container: global (search card)
  - Disabled: Quando isExporting=true OU companies.length=0
  - HasOnClick: true ‚Üí handleExportPDF
  - A√ß√£o esperada: Gerar e baixar PDF da lista
  - Endpoint: N√£o aplic√°vel (gera√ß√£o client-side com jsPDF)
  - Status: ‚úÖ OK - Funcional
  - Observa√ß√µes: Variant outline

Bot√£o 9: Exportar CSV
  - Label: "CSV" + √≠cone Download
  - Data-testid: N√£o definido
  - Aria-label: N√£o definido
  - Container: global (search card)
  - Disabled: Quando isExporting=true OU companies.length=0
  - HasOnClick: true ‚Üí handleExportCSV
  - A√ß√£o esperada: Gerar e baixar CSV completo (87 colunas)
  - Endpoint: N√£o aplic√°vel (gera√ß√£o client-side)
  - Status: ‚úÖ OK - Funcional
  - Observa√ß√µes: Variant outline, exporta com BOM para UTF-8

Bot√£o 10: Exportar XLS
  - Label: "XLS" + √≠cone FileSpreadsheet
  - Data-testid: N√£o definido
  - Aria-label: N√£o definido
  - Container: global (search card)
  - Disabled: Quando isExporting=true OU companies.length=0
  - HasOnClick: true ‚Üí handleExportXLS
  - A√ß√£o esperada: Gerar e baixar Excel (87 colunas)
  - Endpoint: N√£o aplic√°vel (gera√ß√£o client-side com XLSX)
  - Status: ‚úÖ OK - Funcional
  - Observa√ß√µes: Variant outline, auto-ajusta largura de colunas

Bot√£o 11: Exportar PNG
  - Label: "PNG" + √≠cone Image
  - Data-testid: N√£o definido
  - Aria-label: N√£o definido
  - Container: global (search card)
  - Disabled: Quando isExporting=true OU companies.length=0
  - HasOnClick: true ‚Üí handleExportPNG
  - A√ß√£o esperada: Capturar screenshot da tabela e baixar PNG
  - Endpoint: N√£o aplic√°vel (html2canvas)
  - Status: ‚úÖ OK - Funcional
  - Observa√ß√µes: Variant outline, requer [data-testid="companies-table"]

‚ö†Ô∏è PROBLEMAS IDENTIFICADOS NESTA SE√á√ÉO:
  - Input de busca presente (linhas 884-892), mas sem bot√£o "Limpar busca"
  - Bot√µes de exporta√ß√£o n√£o respeitam sele√ß√£o (sempre exportam TODAS as empresas vis√≠veis)
  - FALTA: Op√ß√£o "Exportar selecionadas" vs "Exportar todas filtradas"

================================================================================

SE√á√ÉO 3: A√á√ïES POR LINHA/EMPRESA (TABELA)
Localiza√ß√£o: src/pages/CompaniesManagementPage.tsx (linhas 1107-1328)
Data-testid esperado: company-row
Contexto: Bot√µes no final de cada linha da tabela (coluna "A√ß√µes")
--------------------------------------------------------------------------------

Bot√£o 12: Ver detalhes (por linha)
  - Label: [√≠cone Eye]
  - Data-testid: N√£o definido
  - Aria-label: N√£o definido
  - Container: row
  - Disabled: false
  - HasOnClick: true ‚Üí navigate(`/company/${company.id}`)
  - A√ß√£o esperada: Navegar para p√°gina de detalhes da empresa
  - Endpoint: N√£o aplic√°vel (roteamento)
  - Status: ‚úÖ OK - Funcional
  - Observa√ß√µes: Tooltip "Ver detalhes", variant default, size sm (8x8)

Bot√£o 13: Editar/Salvar Dados (por linha)
  - Label: [√≠cone Edit]
  - Data-testid: N√£o definido
  - Aria-label: N√£o definido
  - Container: row
  - Disabled: false
  - HasOnClick: true ‚Üí navigate(`/search?companyId=${company.id}`)
  - A√ß√£o esperada: Navegar para p√°gina de busca com empresa selecionada para edi√ß√£o
  - Endpoint: N√£o aplic√°vel (roteamento)
  - Status: ‚úÖ OK - Funcional
  - Observa√ß√µes: Tooltip "Editar/Salvar Dados", variant default, size sm (8x8)

Bot√£o 14: Account Strategy Hub (por linha)
  - Label: [√≠cone Target]
  - Data-testid: N√£o definido
  - Aria-label: N√£o definido
  - Container: row
  - Disabled: false
  - HasOnClick: true ‚Üí navigate(`/account-strategy?company=${company.id}&tab=${returnTab}`)
  - A√ß√£o esperada: Navegar para Account Strategy Hub da empresa
  - Endpoint: N√£o aplic√°vel (roteamento)
  - Status: ‚úÖ OK - Funcional
  - Observa√ß√µes: Tooltip "Account Strategy Hub", variant default, size sm (8x8)

Bot√£o 15: Descobrir CNPJ (por linha - condicional)
  - Label: [√≠cone Search]
  - Data-testid: N√£o definido
  - Aria-label: N√£o definido
  - Container: row
  - Disabled: false
  - HasOnClick: true ‚Üí setCnpjCompany + setCnpjDialogOpen
  - A√ß√£o esperada: Abrir dialog de descoberta de CNPJ
  - Endpoint: Usado depois no dialog: POST /functions/v1/discover-cnpj
  - Status: ‚úÖ OK - Funcional
  - Observa√ß√µes: S√≥ aparece quando !company.cnpj, tooltip "Descobrir CNPJ", variant default, size sm (8x8)

Bot√£o 16: Receita Federal (por linha)
  - Label: [√≠cone Building2]
  - Data-testid: N√£o definido
  - Aria-label: N√£o definido
  - Container: row
  - Disabled: Quando enrichingReceitaId === company.id OU !company.cnpj
  - HasOnClick: true ‚Üí handleEnrichReceita(company.id)
  - A√ß√£o esperada: Enriquecer empresa com dados da Receita Federal
  - Endpoint: POST /functions/v1/enrich-receitaws
  - Status: ‚úÖ OK - Funcional
  - Observa√ß√µes: Spinner quando ativo, tooltip "Receita Federal", variant default, size sm (8x8)

Bot√£o 17: Enriquecimento 360¬∞ (por linha)
  - Label: [√≠cone Sparkles]
  - Data-testid: N√£o definido
  - Aria-label: N√£o definido
  - Container: row
  - Disabled: Quando enrichingId === company.id
  - HasOnClick: true ‚Üí handleEnrich(company.id)
  - A√ß√£o esperada: Executar an√°lise 360¬∞ da empresa
  - Endpoint: POST /functions/v1/enrich-company-360
  - Status: ‚úÖ OK - Funcional
  - Observa√ß√µes: Spinner quando ativo, tooltip "Enriquecimento 360¬∞", variant default, size sm (8x8)

Bot√£o 18: Eco-Booster (por linha)
  - Label: [√≠cone Zap]
  - Data-testid: N√£o definido
  - Aria-label: N√£o definido
  - Container: row
  - Disabled: Quando !company.cnpj
  - HasOnClick: true ‚Üí supabase.functions.invoke('enrich-econodata')
  - A√ß√£o esperada: Enriquecer empresa com Econodata
  - Endpoint: POST /functions/v1/enrich-econodata
  - Status: ‚úÖ OK - Funcional
  - Observa√ß√µes: Tooltip "Eco-Booster", variant default, size sm (8x8)

Bot√£o 19: Apollo (Decisores) (por linha)
  - Label: [√≠cone Apollo img]
  - Data-testid: N√£o definido
  - Aria-label: N√£o definido
  - Container: row
  - Disabled: false
  - HasOnClick: true ‚Üí supabase.functions.invoke('enrich-apollo', type: enrich_company)
  - A√ß√£o esperada: Buscar decisores e contatos com Apollo
  - Endpoint: POST /functions/v1/enrich-apollo
  - Status: ‚úÖ OK - Funcional
  - Observa√ß√µes: Tooltip "Apollo (Decisores)", gradient purple-to-blue, size sm (8x8)

Bot√£o 20: Excluir (por linha)
  - Label: [√≠cone Trash2]
  - Data-testid: N√£o definido
  - Aria-label: N√£o definido
  - Container: row
  - Disabled: false
  - HasOnClick: true ‚Üí setCompanyToDelete + setDeleteDialogOpen
  - A√ß√£o esperada: Abrir dialog de confirma√ß√£o de exclus√£o
  - Endpoint: Usado depois no dialog: POST /functions/v1/delete-company
  - Status: ‚úÖ OK - Funcional
  - Observa√ß√µes: Tooltip "Excluir", variant destructive, size sm (8x8)

‚ö†Ô∏è PROBLEMAS IDENTIFICADOS NESTA SE√á√ÉO:
  - ‚ùå REDUND√ÇNCIA CR√çTICA: 9 bot√µes por linha √© excessivo
  - ‚ùå FALTA: Menu consolidado "A√ß√µes" (engrenagem) para agrupar essas a√ß√µes
  - ‚ö†Ô∏è Bot√£o "Account Strategy Hub" deveria estar dentro do menu "A√ß√µes"
  - ‚ö†Ô∏è Bot√µes de enriquecimento deveriam estar em submenu "Enriquecer"
  - ‚ö†Ô∏è Nenhum bot√£o tem estado visual de "j√° enriquecido" vs "pendente"
  - ‚ö†Ô∏è Falta indica√ß√£o visual de ordem de execu√ß√£o dos engines
  - ‚ö†Ô∏è Bot√£o "Apollo" n√£o verifica se org_id/domain est√£o lockados antes
  - ‚ö†Ô∏è Bot√£o "Eco-Booster" n√£o verifica se Receita j√° foi executada antes
  - Espa√ßamento horizontal muito apertado (9 bot√µes pequenos)

RECOMENDA√á√ÉO:
  Consolidar em menu dropdown "A√ß√µes" (√≠cone Settings/Gear):
    ‚îú‚îÄ Ver Detalhes
    ‚îú‚îÄ Editar Dados
    ‚îú‚îÄ Adicionar ao Funil
    ‚îú‚îÄ Account Strategy Hub
    ‚îú‚îÄ Enriquecer ‚ñ∂
    ‚îÇ   ‚îú‚îÄ Receita Federal
    ‚îÇ   ‚îú‚îÄ Apollo (Company)
    ‚îÇ   ‚îú‚îÄ Apollo (People)
    ‚îÇ   ‚îú‚îÄ Similar Companies
    ‚îÇ   ‚îú‚îÄ An√°lise 360¬∞
    ‚îÇ   ‚îî‚îÄ Eco-Booster (Premium)
    ‚îú‚îÄ Descobrir CNPJ (se n√£o tiver)
    ‚îú‚îÄ Atualizar Agora
    ‚îî‚îÄ Excluir

================================================================================

SE√á√ÉO 4: HEADER DA P√ÅGINA DE DETALHE DA EMPRESA
Localiza√ß√£o: src/pages/CompanyDetailPage.tsx (linhas ~230-300)
Data-testid esperado: company-detail-header
Contexto: Bot√µes no header da p√°gina de detalhes, ao lado do nome da empresa
--------------------------------------------------------------------------------

Bot√£o 21: Criar Estrat√©gia (header detalhe)
  - Label: "Criar Estrat√©gia" + √≠cone Target
  - Data-testid: N√£o definido
  - Aria-label: N√£o definido
  - Container: detail (header)
  - Disabled: false
  - HasOnClick: true ‚Üí navigate(`/account-strategy?company=${company.id}`)
  - A√ß√£o esperada: Navegar para Account Strategy Hub
  - Endpoint: N√£o aplic√°vel (roteamento)
  - Status: ‚ö†Ô∏è PROBLEMA - Vis√≠vel sempre, sem valida√ß√£o de pr√©-requisitos
  - Observa√ß√µes: Variant default, bot√£o de destaque no header

  ‚ùå PROBLEMA CR√çTICO:
  - Bot√£o aparece mesmo quando empresa est√° "fria" (sem dados enriquecidos)
  - N√£o valida se:
    ‚Ä¢ Layer 1 = 100% (org_id/domain/CNPJ lockados)
    ‚Ä¢ People v√°lidos ‚â• 1 decisor com LinkedIn can√¥nico
    ‚Ä¢ Empresa no funil ‚â• Qualifica√ß√£o
  - Deveria estar DESABILITADO ou OCULTO at√© pr√©-requisitos serem cumpridos
  - Deveria mostrar tooltip explicando o que falta para habilitar

Bot√£o 22: Atualizar Agora (header detalhe - √≠cone 1)
  - Label: [√≠cone RefreshCw]
  - Data-testid: N√£o definido
  - Aria-label: N√£o definido
  - Container: detail (header)
  - Disabled: false
  - HasOnClick: true ‚Üí handleRefresh
  - A√ß√£o esperada: Recarregar dados da empresa
  - Endpoint: GET /rest/v1/companies?id=eq.{id} (via refetch)
  - Status: ‚úÖ OK - Funcional
  - Observa√ß√µes: √çcone-only, size icon (quadrado)

Bot√£o 23: Copiar Dados (header detalhe - √≠cone 2)
  - Label: [√≠cone Copy]
  - Data-testid: N√£o definido
  - Aria-label: N√£o definido
  - Container: detail (header)
  - Disabled: false
  - HasOnClick: true ‚Üí handleCopyCompanyData
  - A√ß√£o esperada: Copiar JSON dos dados da empresa para clipboard
  - Endpoint: N√£o aplic√°vel (clipboard API)
  - Status: ‚úÖ OK - Funcional
  - Observa√ß√µes: √çcone-only, size icon, toast "Dados copiados!"

Bot√£o 24: Spark/Lightning (header detalhe - √≠cone 3)
  - Label: [√≠cone Zap]
  - Data-testid: N√£o definido
  - Aria-label: N√£o definido
  - Container: detail (header)
  - Disabled: false
  - HasOnClick: N√£o identificado no trecho visualizado
  - A√ß√£o esperada: Provavelmente abrir AI Panel ou Enrichment
  - Endpoint: N√£o identificado
  - Status: ‚ö†Ô∏è NECESSITA VERIFICA√á√ÉO
  - Observa√ß√µes: √çcone-only, size icon, sem tooltip identificado

Bot√£o 25: QR Code (header detalhe - √≠cone 4)
  - Label: [√≠cone QrCode]
  - Data-testid: N√£o definido
  - Aria-label: N√£o definido
  - Container: detail (header)
  - Disabled: false
  - HasOnClick: N√£o identificado no trecho visualizado
  - A√ß√£o esperada: Provavelmente gerar QR Code da empresa ou link
  - Endpoint: N√£o identificado
  - Status: ‚ö†Ô∏è NECESSITA VERIFICA√á√ÉO
  - Observa√ß√µes: √çcone-only, size icon, sem tooltip identificado

Bot√£o 26: Apollo ID Manual (header detalhe - √≠cone 5)
  - Label: "Apollo ID Manual" + √≠cone apollo
  - Data-testid: N√£o definido
  - Aria-label: N√£o definido
  - Container: detail (header)
  - Disabled: false
  - HasOnClick: true ‚Üí Abrir ApolloOrgIdDialog
  - A√ß√£o esperada: Inserir manualmente Apollo Organization ID
  - Endpoint: Usado depois no dialog: POST /functions/v1/enrich-apollo
  - Status: ‚úÖ OK - Funcional
  - Observa√ß√µes: Label + √≠cone, variant secondary

Bot√£o 27: Configura√ß√µes (header detalhe - √≠cone 6)
  - Label: [√≠cone Settings]
  - Data-testid: N√£o definido
  - Aria-label: N√£o definido
  - Container: detail (header)
  - Disabled: false
  - HasOnClick: N√£o identificado no trecho visualizado
  - A√ß√£o esperada: Provavelmente abrir configura√ß√µes da empresa ou integra√ß√µes
  - Endpoint: N√£o identificado
  - Status: ‚ö†Ô∏è NECESSITA VERIFICA√á√ÉO
  - Observa√ß√µes: √çcone-only, size icon, sem tooltip identificado

‚ö†Ô∏è PROBLEMAS IDENTIFICADOS NESTA SE√á√ÉO:
  - ‚ùå "Criar Estrat√©gia" sem valida√ß√£o de pr√©-requisitos (CR√çTICO)
  - ‚ö†Ô∏è 3 bot√µes sem tooltip ou aria-label identificados (Zap, QrCode, Settings)
  - ‚ö†Ô∏è Fun√ß√£o de alguns bot√µes n√£o est√° clara sem tooltip
  - ‚ö†Ô∏è Muitos bot√µes icon-only sem labels visuais
  - ‚ö†Ô∏è Falta agrupamento/hierarquia visual (todos no mesmo n√≠vel)

================================================================================

SE√á√ÉO 5: ABA "A√á√ïES" NA P√ÅGINA DE DETALHE DA EMPRESA
Localiza√ß√£o: src/pages/CompanyDetailPage.tsx (linhas 1362-1370 e adjacentes)
Data-testid: N√£o definido
Contexto: Card "Enriquecimento de Dados" dentro da aba "A√ß√µes"
--------------------------------------------------------------------------------

Bot√£o 28: Enriquecimento 360¬∞ Multi-Layer (aba A√ß√µes)
  - Label: "Enriquecimento 360¬∞ Multi-Layer" (dentro do MultiLayerEnrichButton)
  - Data-testid: N√£o definido
  - Aria-label: N√£o definido
  - Container: detail (aba A√ß√µes > card Enriquecimento)
  - Disabled: false
  - HasOnClick: true ‚Üí Abrir dialog MultiLayerEnrich
  - A√ß√£o esperada: Iniciar enriquecimento multi-camada sequencial
  - Endpoint: POST /functions/v1/enrich-multi-layer (se existir) ou m√∫ltiplas chamadas
  - Status: ‚úÖ OK - Funcional
  - Observa√ß√µes: 
    ‚Ä¢ Adicionado recentemente (√∫ltimo diff)
    ‚Ä¢ Abre dialog com progresso por layer
    ‚Ä¢ ‚ö†Ô∏è PROBLEMA: Progresso geral √∫nico (0%), falta barra individual por layer
    ‚Ä¢ Deveria mostrar status de cada layer: EmpresaQui, Apollo, ReceitaWS, Econodata

Bot√£o 29: Eco-Booster (Econodata) (aba A√ß√µes)
  - Label: Componente EconodataEnrichButton (label interno)
  - Data-testid: N√£o definido
  - Aria-label: N√£o definido
  - Container: detail (aba A√ß√µes > card Enriquecimento)
  - Disabled: Quando !cnpj
  - HasOnClick: true ‚Üí supabase.functions.invoke('enrich-econodata')
  - A√ß√£o esperada: Enriquecer com dados premium Econodata
  - Endpoint: POST /functions/v1/enrich-econodata
  - Status: ‚úÖ OK - Funcional
  - Observa√ß√µes: Componente separado EconodataEnrichButton

Bot√£o 30: Apollo Search (aba A√ß√µes - presumido)
  - Label: Componente ApolloSearchDialog (trigger interno)
  - Data-testid: N√£o definido
  - Aria-label: N√£o definido
  - Container: detail (aba A√ß√µes > card Enriquecimento)
  - Disabled: N√£o identificado
  - HasOnClick: true ‚Üí Abrir ApolloSearchDialog
  - A√ß√£o esperada: Buscar empresa no Apollo e selecionar organiza√ß√£o
  - Endpoint: POST /functions/v1/enrich-apollo (ap√≥s sele√ß√£o)
  - Status: ‚ö†Ô∏è NECESSITA VERIFICA√á√ÉO (componente existe no c√≥digo)
  - Observa√ß√µes: Provavelmente presente no card, mas n√£o visualizado no diff

Bot√£o 31: Enriquecimento Manual (aba A√ß√µes - presumido)
  - Label: Componente ManualEnrichmentDialog (trigger interno)
  - Data-testid: N√£o definido
  - Aria-label: N√£o definido
  - Container: detail (aba A√ß√µes > card Enriquecimento)
  - Disabled: N√£o identificado
  - HasOnClick: true ‚Üí Abrir ManualEnrichmentDialog
  - A√ß√£o esperada: Inserir dados de enriquecimento manualmente
  - Endpoint: Direto no banco (UPDATE companies)
  - Status: ‚ö†Ô∏è NECESSITA VERIFICA√á√ÉO (componente existe no c√≥digo)
  - Observa√ß√µes: Importado mas n√£o visualizado no diff

‚ö†Ô∏è PROBLEMAS IDENTIFICADOS NESTA SE√á√ÉO:
  - ‚ùå MultiLayerEnrichButton: Falta barra de progresso INDIVIDUAL por layer
    ‚Ä¢ Atualmente: "Progresso Geral 0%"
    ‚Ä¢ Necess√°rio: Barra individual para:
      ‚îú‚îÄ EmpresaQui (Layer 1 - Base)
      ‚îú‚îÄ Apollo.io (Layer 2 - Enriquecimento)
      ‚îú‚îÄ ReceitaWS (Layer 2 - Enriquecimento)
      ‚îî‚îÄ Econodata (Layer 3 - Premium)
  - ‚ö†Ô∏è Falta tooltip explicando cada layer e sua fun√ß√£o
  - ‚ö†Ô∏è N√£o indica quais layers j√° foram executados vs pendentes
  - ‚ö†Ô∏è N√£o valida ordem de execu√ß√£o (ex: Econodata antes de Receita)
  - ‚ö†Ô∏è Card "Enriquecimento de Dados" pode ter mais bot√µes n√£o visualizados

================================================================================

MATRIZ DE REDUND√ÇNCIAS (A√á√ïES DUPLICADAS)
--------------------------------------------------------------------------------

A√ß√£o: ENRIQUECER RECEITA FEDERAL
  - Toolbar Global: Bot√£o 2 (lote)
  - Por Linha: Bot√£o 16 (individual)
  - Status: ‚úÖ OK - Contextos diferentes (massa vs individual)

A√ß√£o: ENRIQUECER 360¬∞
  - Toolbar Global: Bot√£o 3 (lote)
  - Por Linha: Bot√£o 17 (individual)
  - Status: ‚úÖ OK - Contextos diferentes (massa vs individual)

A√ß√£o: ENRIQUECER APOLLO (DECISORES)
  - Toolbar Global: Bot√£o 4 (lote)
  - Por Linha: Bot√£o 19 (individual)
  - Detalhe: Bot√£o 30 (presumido, dialog de busca)
  - Status: ‚ö†Ô∏è REDUND√ÇNCIA - 3 pontos de entrada para mesma a√ß√£o
  - Recomenda√ß√£o: Manter toolbar (lote) + menu "A√ß√µes" por linha (individual)

A√ß√£o: ENRIQUECER ECO-BOOSTER (ECONODATA)
  - Toolbar Global: Bot√£o 5 (lote)
  - Por Linha: Bot√£o 18 (individual)
  - Detalhe: Bot√£o 29 (individual)
  - Status: ‚ö†Ô∏è REDUND√ÇNCIA - 3 pontos de entrada para mesma a√ß√£o
  - Recomenda√ß√£o: Manter toolbar (lote) + menu "A√ß√µes" por linha (individual)

A√ß√£o: ATUALIZAR/REFRESH
  - Card Busca: Bot√£o 7 (lista)
  - Header Detalhe: Bot√£o 22 (detalhe)
  - Status: ‚úÖ OK - Contextos diferentes (lista vs detalhe)

A√ß√£o: CRIAR/VER ESTRAT√âGIA
  - Header Detalhe: Bot√£o 21 (sem valida√ß√£o)
  - Por Linha: Bot√£o 14 (Account Strategy Hub)
  - Status: ‚ö†Ô∏è REDUND√ÇNCIA + PROBLEMA
  - Problema: Bot√£o 21 n√£o valida pr√©-requisitos
  - Recomenda√ß√£o: Consolidar em um √∫nico bot√£o com valida√ß√£o

A√ß√£o: BUSCAR EMPRESAS
  - Toolbar Global: Bot√£o 6 (header)
  - Empty State: Bot√£o "Adicionar Primeira Empresa" (linha 952-959)
  - Status: ‚úÖ OK - Contextos diferentes (lista populada vs vazia)

================================================================================

MATRIZ DE CONECTIVIDADE POR BOT√ÉO
(Ser√° preenchida no MICROCICLO 2 - Auditoria de Conectividade)
--------------------------------------------------------------------------------

Aguardando execu√ß√£o dos testes de conectividade para mapear:
  - RequestId de cada chamada
  - Status HTTP de cada endpoint
  - Tempo de resposta
  - Mensagens de erro
  - Pr√©-requisitos de autentica√ß√£o (JWT)

================================================================================

PROBLEMAS PRIORIZADOS (PARA PR√ìXIMOS MICROCICLOS)
--------------------------------------------------------------------------------

üî¥ CR√çTICOS (P0):
  1. Toolbar de processamento em massa REMOVIDA
     - Falta: "Deletar empresas selecionadas"
     - Falta: "Selecionar todas"
     - Falta: Contagem de selecionadas
     - Localiza√ß√£o: Deveria estar antes do card de busca
  
  2. Bot√£o "Criar Estrat√©gia" SEM valida√ß√£o de pr√©-requisitos
     - Aparece mesmo com empresa "fria"
     - N√£o valida Layer 1 completo (org_id/domain/CNPJ)
     - N√£o valida exist√™ncia de decisores
     - N√£o valida est√°gio no funil
     - Localiza√ß√£o: src/pages/CompanyDetailPage.tsx, header
  
  3. MultiLayerEnrichButton: Progresso √öNICO em vez de por layer
     - Usu√°rio n√£o sabe quais layers rodaram
     - N√£o indica sucessos parciais
     - N√£o indica falhas espec√≠ficas por layer
     - Localiza√ß√£o: src/components/canvas/MultiLayerEnrichButton.tsx

üü† IMPORTANTES (P1):
  4. Redund√¢ncia de bot√µes por linha (9 bot√µes √© excessivo)
     - Dificulta usabilidade
     - Ocupa muito espa√ßo horizontal
     - Falta agrupamento em menu "A√ß√µes" (engrenagem)
     - Localiza√ß√£o: src/pages/CompaniesManagementPage.tsx, linhas 1107-1328
  
  5. Falta de ordem/valida√ß√£o na execu√ß√£o dos engines
     - Usu√°rio pode executar Econodata antes de Receita
     - Usu√°rio pode executar Apollo sem org_id lockado
     - Falta indica√ß√£o visual de pr√©-requisitos
     - Afeta: Todos os bot√µes de enriquecimento
  
  6. Bot√µes de exporta√ß√£o n√£o respeitam sele√ß√£o
     - Sempre exportam TODAS as empresas vis√≠veis
     - Falta op√ß√£o "Exportar selecionadas"
     - Localiza√ß√£o: handleExportCSV, handleExportXLS, handleExportPDF, handleExportPNG

üü° MELHORIAS (P2):
  7. Falta de data-testid em TODOS os bot√µes
     - Dificulta automa√ß√£o de testes
     - Dificulta debugging
     - Afeta: Todos os 31 bot√µes mapeados
  
  8. Falta de aria-label em bot√µes icon-only
     - Dificulta acessibilidade
     - Leitores de tela n√£o conseguem identificar fun√ß√£o
     - Afeta: Maioria dos bot√µes (especialmente toolbar global)
  
  9. Tooltips ausentes ou inconsistentes
     - Alguns bot√µes n√£o t√™m tooltip
     - Alguns tooltips n√£o explicam pr√©-requisitos
     - Afeta: Bot√µes 24, 25, 27 (header detalhe) principalmente

================================================================================

PR√ìXIMOS PASSOS
--------------------------------------------------------------------------------

‚úÖ MICROCICLO 1: Invent√°rio DOM de Bot√µes - CONCLU√çDO
  - 31 bot√µes mapeados
  - 5 se√ß√µes analisadas
  - Problemas priorizados em P0/P1/P2

‚è≥ MICROCICLO 2: Auditoria de Conectividade por Bot√£o (PR√ìXIMO)
  - Testar cada bot√£o (clique de teste)
  - Capturar: requestId, URL, status HTTP, tempo
  - Validar autentica√ß√£o JWT
  - Verificar pr√©-requisitos (login, lock de empresa)
  - Preencher matriz de conectividade

‚è≥ MICROCICLO 3: Restabelecer Toolbar de Processamento em Massa
  - Criar toolbar no topo da lista
  - Adicionar: Selecionar tudo, Deletar selecionadas, Enriquecer lote, Exportar selecionadas
  - Garantir estados (enabled/disabled) corretos
  - Adicionar confirma√ß√£o para a√ß√µes destrutivas

‚è≥ MICROCICLO 4: Consolida√ß√£o de Bot√µes por Linha (Menu "A√ß√µes")
  - Criar menu dropdown "A√ß√µes" (√≠cone engrenagem)
  - Agrupar 9 bot√µes atuais em menu hier√°rquico
  - Manter apenas "Ver detalhes" + "A√ß√µes" vis√≠veis

‚è≥ MICROCICLO 5: Regras de Visibilidade/Habilita√ß√£o
  - Implementar valida√ß√£o de pr√©-requisitos para "Criar Estrat√©gia"
  - Desabilitar bot√µes fora de ordem com tooltips explicativos
  - Indicar visualmente quais layers j√° foram executados

‚è≥ MICROCICLO 6: Orquestra√ß√£o de Engines
  - Sequenciar chamadas: Apollo ‚Üí People ‚Üí CNPJ ‚Üí Receita ‚Üí Econodata
  - Bloquear a√ß√µes quando pr√©-requisitos faltarem
  - Mensagens claras de pr√©-requisito

‚è≥ MICROCICLO 7: Telemetria e Logs
  - Instrumentar cliques e resultados
  - Registrar: buttonId, page, requestId, endpoint, status, tempo
  - Criar dashboard de status (OK/Quebrado/Intermitente)

‚è≥ MICROCICLO 8: Corre√ß√µes de Conectividade/Seguran√ßa
  - Garantir Authorization em verify_jwt=true
  - Tratar 401/403 com CTA de login
  - Confirma√ß√£o expl√≠cita para opera√ß√µes destrutivas

‚è≥ MICROCICLO 9: Acessibilidade e UX
  - Adicionar aria-label e data-testid padronizados
  - Tooltips informativos (inclusive para disabled)
  - Estados visuais coerentes (hover/active/focus)

‚è≥ MICROCICLO 10: Relat√≥rio Final e Checkup
  - Consolidar resultados
  - Validar o todo (desktop/mobile, claro/escuro)
  - Checkup de n√£o-regress√£o

================================================================================

ENTREG√ÅVEIS DO MICROCICLO 1
--------------------------------------------------------------------------------

‚úÖ Invent√°rio completo de bot√µes (31 mapeados)
‚úÖ Agrupamento por se√ß√£o (5 se√ß√µes)
‚úÖ Identifica√ß√£o de redund√¢ncias (6 a√ß√µes duplicadas)
‚úÖ Prioriza√ß√£o de problemas (P0/P1/P2)
‚úÖ Relat√≥rio em texto plano (este arquivo)

Total de bot√µes √∫nicos: 31
Total de problemas cr√≠ticos (P0): 3
Total de problemas importantes (P1): 3
Total de melhorias (P2): 3

Status: ‚úÖ MICROCICLO 1 CONCLU√çDO COM SUCESSO

Pr√≥ximo microciclo: MICROCICLO 2 - Auditoria de Conectividade por Bot√£o
  - Testar conectividade de cada bot√£o
  - Registrar evid√™ncias (requestId, status, tempo)
  - Validar autentica√ß√£o e pr√©-requisitos

================================================================================
FIM DO RELAT√ìRIO MICROCICLO 1
================================================================================
